---
phase: 10-trainee-images-fifa-cards
plan: 05
type: execute
wave: 4
depends_on: ["10-04"]
files_modified:
  - src/components/player-card/PlayerCard.tsx
  - src/app/dashboard/page.tsx
  - src/app/dashboard/assessments/page.tsx
autonomous: true

must_haves:
  truths:
    - "FIFA card displays processed cutout image when available"
    - "Card gradient/background shows through transparent areas"
    - "FIFA card falls back to initials when no image"
    - "Dashboard and assessments pages pass processed URL to PlayerCard"
  artifacts:
    - path: "src/components/player-card/PlayerCard.tsx"
      provides: "Updated PlayerCard with transparent cutout support"
      contains: "processedAvatarUrl"
  key_links:
    - from: "PlayerCard.tsx"
      to: "profiles.processed_avatar_url"
      via: "prop"
      pattern: "processedAvatarUrl"
---

<objective>
Update PlayerCard component to use processed cutout images and update pages that render the card to pass the processed URL. Ensure transparency works so card background shows through.

Purpose: Display professional cutout images on FIFA-style player cards
Output: Updated PlayerCard with cutout support, updated pages passing processed URL
</objective>

<execution_context>
@/Users/itayostraich/.claude/get-shit-done/workflows/execute-plan.md
@/Users/itayostraich/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-trainee-images-fifa-cards/10-CONTEXT.md
@.planning/phases/10-trainee-images-fifa-cards/10-04-SUMMARY.md
@src/components/player-card/PlayerCard.tsx
@src/app/dashboard/page.tsx
@src/app/dashboard/assessments/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update PlayerCard for processed cutout images</name>
  <files>src/components/player-card/PlayerCard.tsx</files>
  <action>
Update the PlayerCard component to properly display processed cutout images:

1. **Update props interface:**
   - Keep existing `avatarUrl` for backwards compatibility
   - The avatarUrl prop will now receive the processed (cutout) URL when available
   - No need for separate prop since CONTEXT.md says FIFA card uses processed cutout

2. **Update avatar display section:**
   The current code shows avatar like this:
   ```tsx
   {avatarUrl ? (
     <img
       src={avatarUrl}
       alt={playerName}
       className="object-cover object-top"
       style={{...}}
     />
   ) : (
     // initials fallback
   )}
   ```

   Update to:
   - Remove `object-cover object-top` classes (cutout should display naturally)
   - Use `object-contain` instead to preserve aspect ratio and show full cutout
   - Per CONTEXT.md: Image position is centered (not top-aligned)
   - Per CONTEXT.md: No drop shadow or glow on image itself (card already has glow)

   Updated styles:
   ```tsx
   <img
     src={avatarUrl}
     alt={playerName}
     className="object-contain"
     style={{
       width: "100%",
       height: "100%",
       // No filter/shadow - clean cutout per CONTEXT.md
     }}
   />
   ```

3. **Initials fallback:**
   - Keep existing initials fallback (single first letter)
   - Per CONTEXT.md: "No image fallback: User initials (same style as avatar default)"
   - Current implementation is fine

4. **Transparency:**
   - PNG cutouts have transparent backgrounds
   - The card template image behind shows through automatically
   - No additional CSS needed - transparency just works with PNG

5. **Verify the avatar container:**
   - Current container has overflow-hidden which is correct
   - Position/size is already configured per card size
  </action>
  <verify>
TypeScript compiles:
`npx tsc --noEmit src/components/player-card/PlayerCard.tsx`
  </verify>
  <done>
PlayerCard updated to display cutout images properly with object-contain and centered positioning.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update dashboard and assessments pages to pass processed URL</name>
  <files>src/app/dashboard/page.tsx, src/app/dashboard/assessments/page.tsx</files>
  <action>
Update pages that render PlayerCard to fetch and pass the processed_avatar_url:

1. **Check current data fetching:**
   - Look at how these pages currently fetch profile data
   - Add processed_avatar_url to the select query if not already included

2. **Update dashboard page (src/app/dashboard/page.tsx):**
   - Find where PlayerCard is rendered
   - Find where profile data is fetched
   - Ensure processed_avatar_url is in the query select
   - Pass processed_avatar_url as avatarUrl prop to PlayerCard
   - Fallback to regular avatar_url if processed doesn't exist

   Pattern:
   ```tsx
   <PlayerCard
     avatarUrl={profile.processed_avatar_url || profile.avatar_url}
     // ... other props
   />
   ```

3. **Update assessments page (src/app/dashboard/assessments/page.tsx):**
   - Same pattern as dashboard
   - Ensure processed_avatar_url is fetched
   - Pass to PlayerCard with fallback

4. **Check admin assessment page too:**
   - src/app/admin/assessments/[userId]/page.tsx also uses PlayerCard
   - Update similarly if it renders PlayerCard

5. **Data fetching pattern:**
   If using Supabase query:
   ```typescript
   .select('*, processed_avatar_url')
   // or if selecting specific fields:
   .select('full_name, avatar_url, processed_avatar_url, ...')
   ```
  </action>
  <verify>
TypeScript compiles for all modified pages:
`npx tsc --noEmit src/app/dashboard/page.tsx src/app/dashboard/assessments/page.tsx`
  </verify>
  <done>
Dashboard and assessment pages updated to pass processed_avatar_url to PlayerCard.
  </done>
</task>

</tasks>

<verification>
1. PlayerCard uses object-contain for cutout images
2. PlayerCard shows transparency (card background visible through cutout)
3. Dashboard page passes processed_avatar_url to PlayerCard
4. Assessments page passes processed_avatar_url to PlayerCard
5. All files compile without TypeScript errors
</verification>

<success_criteria>
- [ ] PlayerCard displays cutout images centered with object-contain
- [ ] PlayerCard transparency works (no background on image element)
- [ ] Dashboard fetches processed_avatar_url
- [ ] Dashboard passes processed URL to PlayerCard (with fallback to regular avatar)
- [ ] Assessments page fetches processed_avatar_url
- [ ] Assessments page passes processed URL to PlayerCard (with fallback)
- [ ] TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/10-trainee-images-fifa-cards/10-05-SUMMARY.md`
</output>
