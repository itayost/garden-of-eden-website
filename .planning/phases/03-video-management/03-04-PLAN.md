---
phase: 03-video-management
plan: 04
type: execute
wave: 3
depends_on: ["03-02", "03-03"]
files_modified:
  - src/app/admin/videos/page.tsx
  - src/app/admin/videos/create/page.tsx
autonomous: true

must_haves:
  truths:
    - "Admin can view list of all videos"
    - "Admin can navigate to video creation page"
    - "Admin can create a new video via form"
    - "Admin can edit existing videos inline"
    - "Admin can delete videos with confirmation"
  artifacts:
    - path: "src/app/admin/videos/page.tsx"
      provides: "Video management page with table"
      min_lines: 80
    - path: "src/app/admin/videos/create/page.tsx"
      provides: "Video creation page"
      min_lines: 40
  key_links:
    - from: "src/app/admin/videos/page.tsx"
      to: "src/components/admin/videos/VideoDataTable.tsx"
      via: "component render"
      pattern: "<VideoDataTable"
    - from: "src/app/admin/videos/page.tsx"
      to: "src/components/admin/videos/DeleteVideoDialog.tsx"
      via: "action rendering"
      pattern: "<DeleteVideoDialog"
    - from: "src/app/admin/videos/create/page.tsx"
      to: "src/components/admin/videos/VideoForm.tsx"
      via: "component render"
      pattern: "<VideoForm"
---

<objective>
Upgrade admin videos page to full CRUD interface and create video creation page.

Purpose: Replace read-only video display with full management interface allowing create, edit, and delete.
Output: Upgraded admin videos page with TanStack Table and a new video creation page.
</objective>

<execution_context>
@/Users/itayostraich/.claude/get-shit-done/workflows/execute-plan.md
@/Users/itayostraich/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/03-video-management/03-CONTEXT.md
@.planning/phases/03-video-management/03-01-SUMMARY.md
@.planning/phases/03-video-management/03-02-SUMMARY.md
@.planning/phases/03-video-management/03-03-SUMMARY.md

# Existing pages to follow
@src/app/admin/users/page.tsx
@src/app/admin/users/create/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Upgrade admin videos page</name>
  <files>src/app/admin/videos/page.tsx</files>
  <action>
Replace the existing read-only videos page with full CRUD interface.

Page structure:
1. **Header section:**
   - Title: "ניהול סרטונים"
   - Description: "צפייה, הוספה ועריכה של סרטוני התרגילים"
   - "הוסף סרטון" button linking to /admin/videos/create (Plus icon)

2. **Main content:**
   - Card wrapper with CardHeader showing video count
   - VideoDataTable with data fetched from Supabase

3. **Data fetching (server component):**
   - Verify admin role before rendering (follow existing pattern)
   - Fetch all workout_videos ordered by day_number, order_index
   - Pass data to client component wrapper

4. **Client wrapper for interactivity:**
   - Create a client component (VideoListClient) that wraps VideoDataTable
   - Pass renderActions prop to VideoDataTable for edit/delete buttons

5. **Action buttons per row:**
   - Edit button (Pencil icon) - opens Sheet/Dialog with VideoForm in edit mode
   - Delete button - uses DeleteVideoDialog component

6. **Edit functionality:**
   - Use Sheet component (slides from side) for edit form
   - Pre-populate VideoForm with video data
   - Close sheet and refresh on success

Remove the old "Info Card" about adding videos via Supabase - now admins can add directly.
  </action>
  <verify>Page loads at /admin/videos without errors, shows video list</verify>
  <done>Admin videos page displays table with edit/delete actions per row</done>
</task>

<task type="auto">
  <name>Task 2: Create video creation page</name>
  <files>src/app/admin/videos/create/page.tsx</files>
  <action>
Create video creation page following users/create/page.tsx pattern.

Page structure:
1. **Admin verification:**
   - Server component checks admin role
   - Redirect to /admin if not admin

2. **Header section:**
   - Back button linking to /admin/videos (ArrowRight icon for RTL)
   - Title: "הוספת סרטון חדש"
   - Description: "מלא את הפרטים להוספת סרטון תרגיל חדש"

3. **Form section:**
   - Card wrapper with CardHeader and CardContent
   - VideoForm component with onSuccess callback
   - onSuccess: redirect to /admin/videos using router.push

4. **Layout:**
   - Centered content with max-width (max-w-2xl mx-auto)
   - Consistent spacing with other admin pages
  </action>
  <verify>Page loads at /admin/videos/create without errors, form submits successfully</verify>
  <done>Video creation page displays form and redirects on success</done>
</task>

</tasks>

<verification>
1. Admin videos page loads and displays video data in table
2. "Add Video" button navigates to /admin/videos/create
3. Video creation form validates and creates videos
4. Edit Sheet opens with pre-populated form
5. Delete dialog confirms and removes videos
6. All actions show loading states and toast notifications
</verification>

<success_criteria>
- Admin can view all videos in a sortable, paginated table
- Admin can filter videos by search or day number
- Admin can create new videos via the create page
- Admin can edit existing videos via the edit sheet
- Admin can delete videos with confirmation dialog
- All changes persist and UI refreshes automatically
</success_criteria>

<output>
After completion, create `.planning/phases/03-video-management/03-04-SUMMARY.md`
</output>
