---
phase: 03-video-management
plan: 02
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - src/components/admin/videos/VideoForm.tsx
  - src/components/admin/videos/DeleteVideoDialog.tsx
autonomous: true

must_haves:
  truths:
    - "Video form validates input before submission"
    - "Delete confirmation prevents accidental deletion"
    - "Loading states shown during async operations"
    - "Toast notifications shown on success/error"
  artifacts:
    - path: "src/components/admin/videos/VideoForm.tsx"
      provides: "Create/edit video form"
      min_lines: 100
    - path: "src/components/admin/videos/DeleteVideoDialog.tsx"
      provides: "Delete confirmation dialog"
      min_lines: 50
  key_links:
    - from: "src/components/admin/videos/VideoForm.tsx"
      to: "src/lib/actions/admin-videos.ts"
      via: "server action calls"
      pattern: "(createVideoAction|updateVideoAction)"
    - from: "src/components/admin/videos/DeleteVideoDialog.tsx"
      to: "src/lib/actions/admin-videos.ts"
      via: "server action call"
      pattern: "deleteVideoAction"
---

<objective>
Create video form and delete dialog components for admin video management.

Purpose: Build reusable form and dialog components that can be used in create mode, edit mode, and for deletion.
Output: Two components - VideoForm (create/edit) and DeleteVideoDialog (delete confirmation).
</objective>

<execution_context>
@/Users/itayostraich/.claude/get-shit-done/workflows/execute-plan.md
@/Users/itayostraich/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/03-video-management/03-CONTEXT.md
@.planning/phases/03-video-management/03-RESEARCH.md
@.planning/phases/03-video-management/03-01-SUMMARY.md

# Existing patterns to follow
@src/components/admin/users/UserCreateForm.tsx
@src/components/admin/users/DeleteUserDialog.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create VideoForm component</name>
  <files>src/components/admin/videos/VideoForm.tsx</files>
  <action>
Create form component following UserCreateForm.tsx pattern exactly.

Props interface:
```typescript
interface VideoFormProps {
  video?: WorkoutVideo;  // If provided, edit mode; otherwise create mode
  onSuccess?: () => void;  // Called after successful submit
  onCancel?: () => void;  // Called when cancel clicked
}
```

Form fields (in order):
1. **title** - Input, placeholder "הזן כותרת לסרטון"
2. **youtube_url** - Input dir="ltr", placeholder "https://youtube.com/watch?v=..."
3. **day_number** - Select with options 1-5, show "יום 1" through "יום 5"
4. **day_topic** - Input with auto-fill suggestion when day changes (use getDayTopicSuggestion)
5. **duration_minutes** - Input type="number" min=1 max=120, dir="ltr"
6. **description** - Textarea, optional, placeholder "תיאור קצר של הסרטון (אופציונלי)"

Features:
- Use react-hook-form with zodResolver and videoSchema
- defaultValues from video prop (edit) or empty values with day_number=1 (create)
- When day_number changes, auto-suggest day_topic (but allow user to override)
- Loading state with Loader2 spinner on submit button
- Disable all fields during loading
- Call createVideoAction or updateVideoAction based on mode
- Handle fieldErrors by setting form errors via setError()
- Show toast.success/error appropriately
- Call onSuccess() callback on success

Submit button text:
- Create mode: "הוסף סרטון" with Plus icon
- Edit mode: "שמור שינויים" with Save icon

Add Cancel button that calls onCancel() when provided.
  </action>
  <verify>TypeScript compiles without errors: `npx tsc --noEmit`</verify>
  <done>VideoForm component handles create and edit modes with validation</done>
</task>

<task type="auto">
  <name>Task 2: Create DeleteVideoDialog component</name>
  <files>src/components/admin/videos/DeleteVideoDialog.tsx</files>
  <action>
Create delete confirmation dialog following DeleteUserDialog.tsx pattern exactly.

Props interface:
```typescript
interface DeleteVideoDialogProps {
  video: WorkoutVideo;
  trigger?: React.ReactNode;  // Custom trigger element
  onDeleted?: () => void;  // Called after successful deletion
}
```

Dialog content (Hebrew):
- Title: "מחיקת סרטון"
- Description: "האם אתה בטוח שברצונך למחוק את הסרטון <strong>{video.title}</strong>?"
- Sub-text: "פעולה זו לא ניתנת לביטול. הסרטון יימחק לצמיתות."

Buttons:
- Cancel: "ביטול" - closes dialog
- Confirm: "מחק סרטון" - destructive style, calls deleteVideoAction

Features:
- Use AlertDialog from shadcn/ui
- Loading state with Loader2 spinner
- Disable buttons during loading
- Call deleteVideoAction with video.id
- Show toast.success on success, toast.error on failure
- Close dialog on success
- Call onDeleted() callback on success

Default trigger: Button with Trash2 icon and text "מחיקה"
  </action>
  <verify>TypeScript compiles without errors: `npx tsc --noEmit`</verify>
  <done>DeleteVideoDialog shows confirmation and handles deletion with loading state</done>
</task>

</tasks>

<verification>
1. Both components export and compile without errors
2. VideoForm handles both create and edit modes
3. DeleteVideoDialog shows loading state during deletion
4. All Hebrew text is correct
</verification>

<success_criteria>
- VideoForm validates input and shows field-level errors
- VideoForm auto-suggests day topic when day changes
- DeleteVideoDialog requires confirmation before deleting
- Both components show loading states during async operations
- Toast notifications shown for success and error states
</success_criteria>

<output>
After completion, create `.planning/phases/03-video-management/03-02-SUMMARY.md`
</output>
